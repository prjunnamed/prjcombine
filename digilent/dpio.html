<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DPIO (GPIO) - Project Combine</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">Project Combine</h1>

                    <div class="right-buttons">

                    </div>
                </div>


                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dpio-gpio"><a class="header" href="#dpio-gpio">DPIO (GPIO)</a></h1>
<p>This subsystem is used for simple GPIO control.  A single "port" of this subsystem can support
up to 32 GPIO pins.</p>
<p>The port properties on DPIO are as follows:</p>
<ul>
<li>bit 0: supports inter-byte delay on stream commands (<code>GET_STREAM_TIMING</code> and <code>SET_STREAM_TIMING</code>)</li>
<li>bit 1: supports data streaming command (<code>STREAM_STATE</code>)</li>
</ul>
<h2 id="get_pin_mask"><a class="header" href="#get_pin_mask"><code>GET_PIN_MASK</code></a></h2>
<p>Returns available pins and their allowed directions.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x03</code> (short)</li>
<li>command payload: none</li>
<li>response payload: two 32-bit words:
<ul>
<li>word 0: bitmask of output-capable pins</li>
<li>word 1: bitmask of input-capable pins</li>
</ul>
</li>
</ul>
<p>Pins can be input-only, output-only, or bidirectional.  Bidirectional pins will have bits
set in both masks, while input-only/output-only pins will have a bit set only in only one
of the masks.</p>
<h2 id="set_pin_dir"><a class="header" href="#set_pin_dir"><code>SET_PIN_DIR</code></a></h2>
<p>Sets pin directions.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x04</code> (short)</li>
<li>command payload: 32-bit word: bitmask of pins that should be set to output</li>
<li>response payload: 32-bit word: bitmask of pins currently set to output</li>
</ul>
<p>This command returns the actual mask that has been set.  Note that, as is customary
for garbage GPIO controllers, the pins that have been newly set as outputs will immediately
start to drive a 0 value, and sending a <code>SET_PIN_STATE</code> beforehand will not change this.</p>
<h2 id="get_pin_dir"><a class="header" href="#get_pin_dir"><code>GET_PIN_DIR</code></a></h2>
<p>Returns current pin directions.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x05</code> (short)</li>
<li>command payload: none</li>
<li>response payload: 32-bit word: bitmask of pins currently set to output</li>
</ul>
<h2 id="set_pin_state"><a class="header" href="#set_pin_state"><code>SET_PIN_STATE</code></a></h2>
<p>Sets state of output pins.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x06</code> (short)</li>
<li>command payload: 32-bit word: bitmask of ouptut state for all pins (bits corresponding to input pins are ignored)</li>
<li>response payload: none</li>
</ul>
<h2 id="get_pin_state"><a class="header" href="#get_pin_state"><code>GET_PIN_STATE</code></a></h2>
<p>Returns the current state of all pins.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x07</code> (short)</li>
<li>command payload: none</li>
<li>response payload: 32-bit word: bitmask of current state of all pins</li>
</ul>
<h2 id="set_stream_timing"><a class="header" href="#set_stream_timing"><code>SET_STREAM_TIMING</code></a></h2>
<p>Sets requested timing for the <code>STREAM_STATE</code> command.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x08</code> (short)</li>
<li>command payload: two 32-bit words:
<ul>
<li>word 0: delay in nanoseconds from input sampling to output update</li>
<li>word 1: delay in nanoseconds from output update to input sampling</li>
</ul>
</li>
<li>response payload: two 32-bit words: same format as command payload</li>
</ul>
<p>This command returns the actual timings that will be used (which are adjusted from the requested ones as required by hardware capabilities).</p>
<h2 id="get_stream_timing"><a class="header" href="#get_stream_timing"><code>GET_STREAM_TIMING</code></a></h2>
<p>Gets the timing for the <code>STREAM_STATE</code> command.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x09</code> (short)</li>
<li>command payload: none</li>
<li>response payload: two 32-bit words: same format as <code>SET_STREAM_TIMING</code></li>
</ul>
<h2 id="stream_state"><a class="header" href="#stream_state"><code>STREAM_STATE</code></a></h2>
<p>Performs streaming I/O.  Can access only the first 8 pins.  Pins will be sampled and updated
in a tight loop, and transferred to/from the host as long command payload.</p>
<ul>
<li>subsystem: <code>0x03</code> (DPIO)</li>
<li>command type: <code>0x0a</code> (long)</li>
<li>command short payload: 6 bytes
<ul>
<li>byte 0:
<ul>
<li>0: no output performed</li>
<li>1: stream output data</li>
</ul>
</li>
<li>byte 1:
<ul>
<li>0: no input performed</li>
<li>1: stream input data</li>
</ul>
</li>
<li>bytes 2-5: 32-bit word, number of bytes to be transferred</li>
</ul>
</li>
<li>response payload (end): 1 byte; 0 if all data was transferred at requested rate,
1 if a hang has occured during the transfer (no buffer space was available and
the transfer was temporarily paused)</li>
<li>long data OUT: if output requested, the output data, byte count as specified in the command payload; otherwise, none</li>
<li>long data IN: if input requested, the input data, byte count as specified in the command payload; otherwise, none</li>
</ul>
<p>Each sample will be transferred as one byte over the long payload endpoints.  Note that
the documentation doesn't say whether, for a given sample, output or input is performed first.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../digilent/djtg.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../digilent/depp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../digilent/djtg.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../digilent/depp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>



        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
